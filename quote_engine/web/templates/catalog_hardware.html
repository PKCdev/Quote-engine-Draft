{% extends 'base.html' %}
{% block content %}
  <h1>Hardware Catalog</h1>
  <p><a class="btn" href="/catalogs/hardware/import">Import Prices (upload saved HTML)</a></p>
  <table>
    <tr><th>Description (key)</th><th>Unit Price (AUD)</th><th>Pack Size</th></tr>
    {% for name, rec in hardware.items() %}
    <tr>
      <td>{{ name }}</td>
      <td>
        {% set unit_price = rec.get('unit_price_aud_ex_gst') %}
        <form action="/catalogs/hardware/set_price" method="post" style="display:flex; gap:4px; align-items:center;">
          <input type="hidden" name="name" value="{{ name }}" />
          <input type="hidden" name="origin" value="catalog" />
          {% if return_url %}<input type="hidden" name="return_url" value="{{ return_url }}" />{% endif %}
          {% if current_project %}<input type="hidden" name="project" value="{{ current_project }}" />{% endif %}
          <input name="unit_price" type="number" step="0.01" value="{{ '%.2f'|format(unit_price | float) if unit_price is not none else '' }}" style="width:7em;" />
          <button class="btn" type="submit">Save</button>
        </form>
      </td>
      <td>{{ rec.pack_size or 1 }}</td>
    </tr>
    {% endfor %}
  </table>

  <h2>Add New Hardware</h2>
  <form method="post" action="/catalogs/hardware/add">
    <input type="hidden" name="origin" value="catalog" />
    {% if return_url %}<input type="hidden" name="return_url" value="{{ return_url }}" />{% endif %}
    {% if current_project %}<input type="hidden" name="project" value="{{ current_project }}" />{% endif %}
    <div class="row"><label>Description (exact as in WOS)</label><br><input name="name" type="text" placeholder="e.g., Blum CLIP top 110Â° Hinge" value="{{ request.query_params.get('name','') }}" required /></div>
    <div class="row"><label>Unit Price (AUD, ex-GST)</label><br><input name="unit_price" type="number" step="0.01" required /></div>
    <div class="row"><label>Pack Size</label><br><input name="pack_size" type="number" step="1" value="1" /></div>
    <button class="btn" type="submit">Add</button>
  </form>
{% endblock %}
